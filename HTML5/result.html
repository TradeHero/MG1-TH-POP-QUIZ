<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width"/>
    <title></title>
    <link href="css/reset.css" rel="stylesheet"/>
    <style>

        html {
            height: 100%;
            font-family: "Avenir Next", sans-serif;
            font-size: 1.2em;
            font-weight: 400;
        }

        div#base-container {
            background: url('./resources/popquiz-result/popquiz-result-bg.png');
            position: absolute;
            left: 0;
            right: 0;
            margin-left: auto;
            margin-right: auto;
        }

        div#selfBox, #awayBox {
            background: url('./resources/popquiz-result/popquiz-result-scorebox.png');
            background-size: contain;
            position: absolute;
        }

        div#selfAvatar, #awayAvatar {
            border-radius: 50%;
            border: 2px solid #fff;
            position: relative;
            width: 100px;
            height: 100px;
            background: #fff;
        }

        div.score-box {
            border-radius: 3px;
            border: 2px solid #FDDFA3;
            background: #FFF1D5;
            position: absolute;
        }

        div#resultTable {
            margin-top: 1%;
            overflow: hidden;
        }

        span.user-name {
            color: #fff;
            width: 200px;
            display: inline-block;
            position: relative;
        }

        div.score-header {
            background: #FF4069;
            font-size: 1.2em;
            color: #fff;
            font-weight: 400;
            width: 96%;
            padding: 2%;
        }

        span#versusSpan {
            position: absolute;
            font-size: 2em;
            color: #fff;
        }

        div.score-header-avatar {
            display: inline-block;
            width: 23%;
            text-align: center;
        }

        div.score-row-score {
            text-align: center;
            display: inline-block;
            width: 22% !important;
            font-weight: bold;
        }

        .score-row-seconds {
            font-size: 0.6em;
        }

        div.score-header-title {
            display: inline-block;
            width: 50%;
        }

        div.score-row {
            padding: 10px 5px;
            margin: 0 10px;
            border-bottom: solid 1px darkgray;
            vertical-align: middle;
        }

        div.score-row .score-row-title {
            display: inline-block;
            width: 52%;
        }

        div.score-row-last {
            border-bottom: 0;
            background: none;
        }

        div#hintsUsedBox {
            margin-top: 2%;
        }

        div#winningStreakBox {
            margin-top: 3%;
        }

        div#totalScoreBox {
            margin-top: 4%;
        }

        .red-text {
            color: darkred !important;
        }

        .green-text {
            color: darkgreen !important;
        }

        .black-text {
            color: #070707 !important;
        }

        #nextButtonContainer {
            position: absolute;
            left: 50%;
            margin-top: 5%;
        }

        #nextButtonInner {
            position: relative;
            left: -50%;
            color: #ffffff;
        }

        .button {
            min-width: 300px;
            padding: 5%;
            background: #28ee28;
            text-align: center;
        }

        .button:hover {
            background: darkgray;
        }

        .score-rows-container {
            height: 100%;
            width: 105%;
            overflow: auto;
        }
    </style>
</head>
<body>
<div id="base-container">
    <div id="selfBox">
        <div id="selfAvatar">
            <span class="user-name" id="selfUserName">Ryne Cheow</span>
        </div>

    </div>
    <span id="versusSpan">VS</span>

    <div id="awayBox">
        <div id="awayAvatar">
            <span class="user-name" id="awayUserName">James Lai</span>
        </div>
    </div>
    <div id="resultTable" class="score-box">
        <div id="scoreHeader" class="score-header">
            <div class="score-header-title">Correct Answers</div>
            <div class="score-header-avatar" id="selfAvatarSmall">You</div>
            <div class="score-header-avatar" id="awayAvatarSmall">Someone</div>
        </div>
        <div id="scoreRows" class="score-rows-container">

        </div>
    </div>
    <div id="hintsUsedBox" class="score-box">
        <div class="score-row score-row-last red-text">
            <div class="score-row-title">
                Hints Used
            </div>
            <div class="score-row-score" id="selfHintsUsed">You</div>
            <div class="score-row-score" id="awayHintsUsed"></div>
        </div>
    </div>
    <div id="winningStreakBox" class="score-box">
        <div class="score-row score-row-last green-text">
            <div class="score-row-title">
                Winning Streak
            </div>
            <div class="score-row-score" id="selfWinningStreak">You</div>
            <div class="score-row-score" id="awayWinningStreak"></div>
        </div>
    </div>
    <div id="totalScoreBox" class="score-box">
        <div class="score-row score-row-last black-text">
            <div class="score-row-title">
                Total Score
            </div>
            <div class="score-row-score" id="selfTotalScore">You</div>
            <div class="score-row-score" id="awayTotalScore"></div>
        </div>
    </div>
    <div id="nextButtonContainer">
        <div id="nextButtonInner" class="button">
            Challenge Others
        </div>
    </div>
</div>
<script>
    var selfAvatarUrl = 'https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-xpa1/v/t1.0-9/10897857_10152660162678602_6790690705278772203_n.jpg?oh=8780f221df3a3aae66a05fe2148b8c4a&oe=559394A0&__gda__=1431074230_4a51cab2b7edc62e3bd23317e40a2c7b';
    var awayAvatarUrl = './resources/profile_pic.jpg';
    var resultString = '{"result":{"challenger":{"gameId":150,"hintsUsed":0,"correctStreak":5,"userId":2415,"score":110000,"details":"3398, 7500, 0.1|3252, 10000, 0.1|4001, 15000, 0.1|3633, 0, 0.6|4096, 7500, 0.1|3823, 10000, 0.3|3620, 15000, 0.3|4051, 20000, 0.3|3732, 25000, 0.1","submittedAtUtc":"2015-02-04T08:16:53"}},"gameId":150}';
</script>
<script>
    //UI auto-resizing/layouting
    var baseContainer = document.getElementById("base-container");
    var selfBox = document.getElementById("selfBox");
    var awayBox = document.getElementById("awayBox");
    var selfAvatar = document.getElementById("selfAvatar");
    var awayAvatar = document.getElementById("awayAvatar");
    var versusSpan = document.getElementById("versusSpan");
    var resultTable = document.getElementById("resultTable");
    var awayHintsUsed = document.getElementById("awayHintsUsed");
    var awayWinningStreak = document.getElementById("awayWinningStreak");
    var awayTotalScore = document.getElementById("awayTotalScore");

    /////////////////// BASE ///////////////////
    var baseHeight = window.innerHeight;
    var baseWidth = window.innerHeight * 0.75;
    baseContainer.style.height = "100%";
    baseContainer.style.width = baseWidth + "px";

    /////////////////// SELF BOX ///////////////////

    var selfAwayWHRatio = 258 / 121;
    var selfBoxWidth = baseWidth * 0.4;
    var selfBoxHeight = selfBoxWidth / selfAwayWHRatio;
    selfBox.style.width = selfBoxWidth + 'px';
    selfBox.style.height = selfBoxHeight + 'px';

    var selfAwayBoxTop = baseHeight * 0.1;
    var selfBoxLeft = baseHeight * 0.03;
    selfBox.style.top = selfAwayBoxTop + 'px';
    selfBox.style.left = selfBoxLeft + 'px';

    ///////// self avatar ///////
    var selfAvatarTop = selfBoxHeight * 0.1;
    var selfAvatarLeft = selfBoxWidth * 0.05;
    selfAvatar.style.top = selfAvatarTop + 'px';
    selfAvatar.style.left = selfAvatarLeft + 'px';

    var selfAvatarHeight = selfBoxHeight * 0.7;
    selfAvatar.style.width = selfAvatarHeight + 'px';
    selfAvatar.style.height = selfAvatarHeight + 'px';

    if (selfAvatarUrl != null) {
        selfAvatar.style.background = 'url(\'' + selfAvatarUrl + '\')';
        selfAvatar.style.backgroundSize = 'cover';
    }

    //username span
    var selfUserNameSpan = document.getElementById('selfUserName');
    var selfUserNameSpanWidth = 0.6 * selfBoxWidth;
    var selfUserNameSpanHeight = 0.1 * selfBoxHeight;
    selfUserNameSpan.style.width = selfUserNameSpanWidth + 'px';
    selfUserNameSpan.style.height = selfUserNameSpanHeight + 'px';

    var selfUserNameSpanTop = selfBoxHeight * 0.25;
    var selfUserNameSpanLeft = selfBoxWidth * 0.05 + selfAvatarHeight;
    selfUserNameSpan.style.top = selfUserNameSpanTop + 'px';
    selfUserNameSpan.style.left = selfUserNameSpanLeft + 'px';
    /////////////////// AWAY BOX ///////////////////

    var awayBoxWidth = baseWidth * 0.4;
    var awayBoxHeight = awayBoxWidth / selfAwayWHRatio;
    awayBox.style.width = awayBoxWidth + 'px';
    awayBox.style.height = awayBoxHeight + 'px';

    var awayBoxLeft = 4 * selfBoxLeft + selfBoxWidth;
    awayBox.style.top = selfAwayBoxTop + 'px';
    awayBox.style.left = awayBoxLeft + 'px';

    ///////// AWAY avatar ///////
    var awayAvatarTop = awayBoxHeight * 0.1;
    var awayAvatarLeft = awayBoxWidth * 0.05;
    awayAvatar.style.top = awayAvatarTop + 'px';
    awayAvatar.style.left = awayAvatarLeft + 'px';

    var awayAvatarHeight = awayBoxHeight * 0.7;
    awayAvatar.style.width = awayAvatarHeight + 'px';
    awayAvatar.style.height = awayAvatarHeight + 'px';
    if (awayAvatarUrl) {
        awayAvatar.style.background = 'url(\'' + awayAvatarUrl + '\')';
        awayAvatar.style.backgroundSize = 'cover';
    }
    //username span
    var awayUserNameSpan = document.getElementById('awayUserName');
    var awayUserNameSpanWidth = 0.6 * awayBoxWidth;
    var awayUserNameSpanHeight = 0.1 * awayBoxHeight;
    awayUserNameSpan.style.width = awayUserNameSpanWidth + 'px';
    awayUserNameSpan.style.height = awayUserNameSpanHeight + 'px';

    var awayUserNameSpanTop = awayBoxHeight * 0.25;
    var awayUserNameSpanLeft = awayBoxWidth * 0.05 + awayAvatarHeight;
    awayUserNameSpan.style.top = awayUserNameSpanTop + 'px';
    awayUserNameSpan.style.left = awayUserNameSpanLeft + 'px';

    /////////////////// VERSUS SPAN ///////////////////
    var versusSpanLeft = 1.15 * selfBoxWidth;
    var versusSpanTop = 1.5 * selfAwayBoxTop;

    versusSpan.style.left = versusSpanLeft + 'px';
    versusSpan.style.top = versusSpanTop + 'px';

    var result = JSON.parse(resultString);
    var resultArr = result.result.challenger.details.split('|');

    /////
    var scoreTableTop = selfAwayBoxTop + selfBox.offsetHeight;
    var scoreRows = document.getElementById('scoreRows');
    resultTable.style.left = selfBox.style.left;
    resultTable.style.top = scoreTableTop + 'px';
    resultTable.style.width = (baseWidth - (selfBoxLeft * 2)) + 'px';
    resultTable.style.height = baseWidth * 0.4 + 'px';

    resultArr.forEach(function (res) {
        var data = res.split(',');
        var questionNode = document.createElement('div');
        questionNode.className = questionNode.className + ' score-row';


        var questionTypeNode = document.createElement('div');
        var questionTypeText = document.createTextNode('? Question Type');
        questionTypeNode.className = questionTypeNode.className + ' score-row-title';
        questionTypeNode.appendChild(questionTypeText);
        questionNode.appendChild(questionTypeNode);

        var selfScoreNode = document.createElement('div');
        selfScoreNode.className = selfScoreNode.className + ' score-row-score score-row-seconds';
        var selfTextNode = document.createTextNode('You');
        selfScoreNode.appendChild(selfTextNode);
        questionNode.appendChild(selfScoreNode);

        var awayScoreNode = document.createElement('div');
        awayScoreNode.className = awayScoreNode.className + ' score-row-score score-row-seconds';
        var awayTextNode = document.createTextNode(data[2]);
        awayScoreNode.appendChild(awayTextNode);
        questionNode.appendChild(awayScoreNode);

        scoreRows.appendChild(questionNode)
    });

    //Hints Used
    var hintsUsedBox = document.getElementById('hintsUsedBox');
    var hintUsedTop = scoreTableTop + resultTable.offsetHeight;
    hintsUsedBox.style.left = selfBox.style.left;
    hintsUsedBox.style.top = hintUsedTop + 'px';
    hintsUsedBox.style.width = resultTable.style.width;
    var awayHintText = document.createTextNode(result.result.challenger.hintsUsed);
    awayHintsUsed.appendChild(awayHintText);

    //Winning Streak
    var winningStreakBox = document.getElementById('winningStreakBox');
    var winningStreakTop = hintUsedTop + hintsUsedBox.offsetHeight;
    winningStreakBox.style.left = selfBox.style.left;
    winningStreakBox.style.top = winningStreakTop + 'px';
    winningStreakBox.style.width = resultTable.style.width;
    var awayStreakText = document.createTextNode('x' + result.result.challenger.correctStreak);
    awayWinningStreak.appendChild(awayStreakText);

    //Total Score
    var totalScoreBox = document.getElementById('totalScoreBox');
    var totalScoreBoxTop = winningStreakTop + winningStreakBox.offsetHeight;
    totalScoreBox.style.left = selfBox.style.left;
    totalScoreBox.style.top = totalScoreBoxTop + 'px';
    totalScoreBox.style.width = resultTable.style.width;
    var awayScore = document.createTextNode(result.result.challenger.score);
    awayTotalScore.appendChild(awayScore);

    //Next Button
    var nextButton = document.getElementById('nextButtonContainer');
    nextButton.style.top = totalScoreBoxTop + totalScoreBox.offsetHeight + 'px';

</script>
</body>
</html>